(function(){"use strict";var e={8873:function(e,s,a){var t=a(9242),o=a(3396);function n(e,s,a,t,n,r){const l=(0,o.up)("NavBar"),c=(0,o.up)("router-view");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o.Wm)(l),((0,o.wg)(),(0,o.j4)(c,{key:e.$route.fullPath}))],64)}a(8052);var r=a(7139);const l={class:"navbar navbar-dark bg-dark navbar-expand-lg navbar-light bg-light"},c={class:"container"},u=(0,o.Uk)("MySpace"),i=(0,o._)("button",{class:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarText","aria-controls":"navbarText","aria-expanded":"false","aria-label":"Toggle navigation"},[(0,o._)("span",{class:"navbar-toggler-icon"})],-1),p={class:"collapse navbar-collapse",id:"navbarText"},d={class:"navbar-nav me-auto mb-2 mb-lg-0"},m={class:"nav-item"},f=(0,o.Uk)("首页"),_={class:"nav-item"},v=(0,o.Uk)("好友列表"),w={key:0,class:"navbar-nav"},g={class:"nav-item"},b=(0,o.Uk)("登录"),y={class:"nav-item"},h=(0,o.Uk)("注册"),k={key:1,class:"navbar-nav"},C={class:"nav-item"},j={class:"nav-item"};function U(e,s,a,t,n,U){const P=(0,o.up)("router-link");return(0,o.wg)(),(0,o.iD)("nav",l,[(0,o._)("div",c,[(0,o.Wm)(P,{class:"navbar-brand",to:{name:"home"}},{default:(0,o.w5)((()=>[u])),_:1}),i,(0,o._)("div",p,[(0,o._)("ul",d,[(0,o._)("li",m,[(0,o.Wm)(P,{class:"nav-link active","aria-current":"page",to:{name:"home"}},{default:(0,o.w5)((()=>[f])),_:1})]),(0,o._)("li",_,[(0,o.Wm)(P,{class:"nav-link",to:{name:"userlist"}},{default:(0,o.w5)((()=>[v])),_:1})])]),e.$store.state.user.is_login?((0,o.wg)(),(0,o.iD)("ul",k,[(0,o._)("li",C,[(0,o.Wm)(P,{class:"nav-link active",ari:"","a-current":"page",to:{name:"userprofile",params:{userId:e.$store.state.user.id}}},{default:(0,o.w5)((()=>[(0,o.Uk)((0,r.zw)(e.$store.state.user.username),1)])),_:1},8,["to"])]),(0,o._)("li",j,[(0,o._)("a",{class:"nav-link",style:{cursor:"pointer"},onClick:s[0]||(s[0]=(...e)=>t.logout&&t.logout(...e))},"退出")])])):((0,o.wg)(),(0,o.iD)("ul",w,[(0,o._)("li",g,[(0,o.Wm)(P,{class:"nav-link active",ari:"","a-current":"page",to:{name:"login"}},{default:(0,o.w5)((()=>[b])),_:1})]),(0,o._)("li",y,[(0,o.Wm)(P,{class:"nav-link",to:{name:"register"}},{default:(0,o.w5)((()=>[h])),_:1})])]))])])])}var P=a(65),x={name:"NarBar",setup(){const e=(0,P.oR)(),s=()=>{e.commit("logout")};return{logout:s}}},B=a(89);const O=(0,B.Z)(x,[["render",U]]);var D=O,T={name:"App",components:{NavBar:D}};const z=(0,B.Z)(T,[["render",n]]);var I=z,S=a(678);const H=(0,o.Uk)(" 首页 ");function W(e,s,a,t,n,r){const l=(0,o.up)("ContentBase");return(0,o.wg)(),(0,o.j4)(l,null,{default:(0,o.w5)((()=>[H])),_:1})}const Z={class:"home"},A={class:"container"},q={class:"card"},R={class:"card-body"};function V(e,s,a,t,n,r){return(0,o.wg)(),(0,o.iD)("div",Z,[(0,o._)("div",A,[(0,o._)("div",q,[(0,o._)("div",R,[(0,o.WI)(e.$slots,"default",{},void 0,!0)])])])])}var E={name:"ContentBase"};const M=(0,B.Z)(E,[["render",V],["__scopeId","data-v-913c8508"]]);var F=M,$={name:"HomeView",components:{ContentBase:F}};const N=(0,B.Z)($,[["render",W]]);var G=N;const L=["onClick"],Y={class:"card-body"},K={class:"row"},J={class:"col-1"},Q=["src"],X={class:"col-11"},ee={class:"username"},se={class:"follower-count"};function ae(e,s,a,t,n,l){const c=(0,o.up)("ContentBase");return(0,o.wg)(),(0,o.j4)(c,null,{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(t.users,(e=>((0,o.wg)(),(0,o.iD)("div",{class:"card",key:e.id,onClick:s=>t.open_user_profile(e.id)},[(0,o._)("div",Y,[(0,o._)("div",K,[(0,o._)("div",J,[(0,o._)("img",{class:"img-fluid",src:e.photo,alt:""},null,8,Q)]),(0,o._)("div",X,[(0,o._)("div",ee,(0,r.zw)(e.username),1),(0,o._)("div",se,(0,r.zw)(e.followerCount),1)])])])],8,L)))),128))])),_:1})}var te=a(7387),oe=a.n(te),ne=a(4870),re={name:"UserList",components:{ContentBase:F},setup(){const e=(0,P.oR)();let s=(0,ne.iH)([]);oe().ajax({url:"https://app165.acapp.acwing.com.cn/myspace/userlist/",type:"get",success(e){s.value=e}});const a=s=>{e.state.user.is_login?Ps.push({name:"userprofile",params:{userId:s}}):Ps.push({name:"login"})};return{users:s,open_user_profile:a}}};const le=(0,B.Z)(re,[["render",ae],["__scopeId","data-v-19a49c03"]]);var ce=le;const ue={class:"row"},ie={class:"col-3"},pe={class:"col-9"};function de(e,s,a,t,n,r){const l=(0,o.up)("UserProfileinfo"),c=(0,o.up)("UserProfileWrite"),u=(0,o.up)("UserProfilePosts"),i=(0,o.up)("ContentBase");return(0,o.wg)(),(0,o.j4)(i,null,{default:(0,o.w5)((()=>[(0,o._)("div",ue,[(0,o._)("div",ie,[(0,o.Wm)(l,{onFollow:t.follow,onUnfollow:t.unfollow,user:t.user},null,8,["onFollow","onUnfollow","user"]),t.is_me?((0,o.wg)(),(0,o.j4)(c,{key:0,onPost_a_post:t.post_a_post},null,8,["onPost_a_post"])):(0,o.kq)("",!0)]),(0,o._)("div",pe,[(0,o.Wm)(u,{user:t.user,posts:t.posts,onDelete_a_post:t.delete_a_post},null,8,["user","posts","onDelete_a_post"])])])])),_:1})}const me={class:"card"},fe={class:"card-body"},_e={class:"row"},ve={class:"col-3"},we=["src"],ge={class:"col-9"},be={class:"username"},ye={clase:"fans"};function he(e,s,a,t,n,l){return(0,o.wg)(),(0,o.iD)("div",me,[(0,o._)("div",fe,[(0,o._)("div",_e,[(0,o._)("div",ve,[(0,o._)("img",{class:"img-fluid",src:a.user.photo,alt:""},null,8,we)]),(0,o._)("div",ge,[(0,o._)("div",be,(0,r.zw)(a.user.username),1),(0,o._)("div",ye,"粉丝: "+(0,r.zw)(a.user.followerCount),1),a.user.is_followed?(0,o.kq)("",!0):((0,o.wg)(),(0,o.iD)("button",{key:0,onClick:s[0]||(s[0]=(...e)=>t.follow&&t.follow(...e)),type:"button",class:"btn btn-sm btn-primary"},"+关注")),a.user.is_followed?((0,o.wg)(),(0,o.iD)("button",{key:1,onClick:s[1]||(s[1]=(...e)=>t.unfollow&&t.unfollow(...e)),type:"button",class:"btn btn-sm btn-primary"},"取消关注")):(0,o.kq)("",!0)])])])])}var ke={name:"UserProfileinfo",props:{user:{type:Object,required:!0}},setup(e,s){const a=(0,P.oR)(),t=()=>{oe().ajax({url:"https://app165.acapp.acwing.com.cn/myspace/follow/",type:"POST",data:{target_id:e.user.id},headers:{Authorization:"Bearer "+a.state.user.access},success(e){"success"===e.result&&s.emit("follow")}})},o=()=>{oe().ajax({url:"https://app165.acapp.acwing.com.cn/myspace/follow/",type:"POST",data:{target_id:e.user.id},headers:{Authorization:"Bearer "+a.state.user.access},success(e){"success"===e.result&&s.emit("unfollow")}})};return{follow:t,unfollow:o}}};const Ce=(0,B.Z)(ke,[["render",he],["__scopeId","data-v-d3c1d2ec"]]);var je=Ce;const Ue={class:"card"},Pe={class:"card-body"},xe={class:"card single-post"},Be={class:"card-body"},Oe=["onClick"];function De(e,s,a,t,n,l){return(0,o.wg)(),(0,o.iD)("div",Ue,[(0,o._)("div",Pe,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(a.posts.posts,(e=>((0,o.wg)(),(0,o.iD)("div",{key:e.id},[(0,o._)("div",xe,[(0,o._)("div",Be,[(0,o.Uk)((0,r.zw)(e.content)+" ",1),t.is_me?((0,o.wg)(),(0,o.iD)("button",{key:0,onClick:s=>t.delete_a_post(e.id),type:"button",class:"btn btn-danger btn-small"},"删除",8,Oe)):(0,o.kq)("",!0)])])])))),128))])])}var Te={name:"UserProfilePosts",props:{posts:{type:Object,required:!0},user:{type:Object,required:!0}},setup(e,s){const a=(0,P.oR)();let t=(0,o.Fl)((()=>a.state.user.id===e.user.id));const n=e=>{oe().ajax({url:"https://app165.acapp.acwing.com.cn/myspace/post/",type:"DELETE",data:{post_id:e},headers:{Authorization:"Bearer "+a.state.user.access},success(a){"success"===a.result&&s.emit("delete_a_post",e)}})};return{is_me:t,delete_a_post:n}}};const ze=(0,B.Z)(Te,[["render",De],["__scopeId","data-v-3e1f0c64"]]);var Ie=ze;const Se=e=>((0,o.dD)("data-v-5ef22c28"),e=e(),(0,o.Cn)(),e),He={class:"card edit-field"},We={class:"card-body"},Ze=Se((()=>(0,o._)("label",{for:"edit-post",class:"form-label"},"编辑区",-1)));function Ae(e,s,a,n,r,l){return(0,o.wg)(),(0,o.iD)("div",He,[(0,o._)("div",We,[Ze,(0,o.wy)((0,o._)("textarea",{"onUpdate:modelValue":s[0]||(s[0]=e=>n.content=e),class:"form-control",id:"edit-post",rows:"3"},null,512),[[t.nr,n.content]]),(0,o._)("button",{onClick:s[1]||(s[1]=(...e)=>n.post_a_post&&n.post_a_post(...e)),type:"button",class:"btn btn-primary bt-sm"},"发帖")])])}var qe={name:"UserProfileWrite",setup(e,s){const a=(0,P.oR)();let t=(0,ne.iH)("");const o=()=>{oe().ajax({url:"https://app165.acapp.acwing.com.cn/myspace/post/",type:"POST",data:{content:t.value},headers:{Authorization:"Bearer "+a.state.user.access},success(e){"success"===e.result&&(s.emit("post_a_post",t.value),t.value="")}}),s.emit("post_a_post",t.value),t.value=""};return{content:t,post_a_post:o}}};const Re=(0,B.Z)(qe,[["render",Ae],["__scopeId","data-v-5ef22c28"]]);var Ve=Re,Ee={name:"UserProfile",components:{ContentBase:F,UserProfileinfo:je,UserProfilePosts:Ie,UserProfileWrite:Ve},setup(){const e=(0,P.oR)(),s=(0,S.yj)(),a=parseInt(s.params.userId),t=(0,ne.qj)({}),n=(0,ne.qj)({});oe().ajax({url:"https://app165.acapp.acwing.com.cn/myspace/getinfo/",type:"GET",data:{user_id:a},headers:{Authorization:"Bearer "+e.state.user.access},success(e){t.id=e.id,t.username=e.username,t.photo=e.photo,t.followerCount=e.followerCount,t.is_followed=e.is_followed}}),oe().ajax({url:"https://app165.acapp.acwing.com.cn/myspace/post/",type:"GET",data:{user_id:a},headers:{Authorization:"Bearer "+e.state.user.access},success(e){n.count=e.length,n.posts=e}});const r=()=>{t.is_followed||(t.is_followed=!0,t.followerCount++)},l=()=>{t.is_followed&&(t.is_followed=!1,t.followerCount--)},c=e=>{n.count++,n.posts.unshift({id:n.count,userId:1,content:e})},u=e=>{n.posts=n.posts.filter((s=>s.id!==e)),n.count=n.posts.length},i=(0,o.Fl)((()=>a===e.state.user.id));return{user:t,follow:r,unfollow:l,posts:n,post_a_post:c,delete_a_post:u,is_me:i}}};const Me=(0,B.Z)(Ee,[["render",de]]);var Fe=Me;const $e=e=>((0,o.dD)("data-v-6d27a999"),e=e(),(0,o.Cn)(),e),Ne={class:"row justify-content-md-center"},Ge={class:"col-3"},Le={class:"mb-3"},Ye=$e((()=>(0,o._)("label",{for:"username",class:"form-label"},"用户名",-1))),Ke={class:"mb-3"},Je=$e((()=>(0,o._)("label",{for:"password",class:"form-label"},"密码",-1))),Qe={class:"error-message"},Xe=$e((()=>(0,o._)("button",{type:"submit",class:"btn btn-primary"},"登录",-1)));function es(e,s,a,n,l,c){const u=(0,o.up)("ContentBase");return(0,o.wg)(),(0,o.j4)(u,null,{default:(0,o.w5)((()=>[(0,o._)("div",Ne,[(0,o._)("div",Ge,[(0,o._)("form",{onSubmit:s[2]||(s[2]=(0,t.iM)(((...e)=>n.login&&n.login(...e)),["prevent"]))},[(0,o._)("div",Le,[Ye,(0,o.wy)((0,o._)("input",{"onUpdate:modelValue":s[0]||(s[0]=e=>n.username=e),type:"text",class:"form-control",id:"username"},null,512),[[t.nr,n.username]])]),(0,o._)("div",Ke,[Je,(0,o.wy)((0,o._)("input",{"onUpdate:modelValue":s[1]||(s[1]=e=>n.password=e),type:"password",class:"form-control",id:"password"},null,512),[[t.nr,n.password]])]),(0,o._)("div",Qe,(0,r.zw)(n.error_meassage),1),Xe],32)])])])),_:1})}var ss={name:"LoginView",components:{ContentBase:F},setup(){const e=(0,P.oR)();let s=(0,ne.iH)(""),a=(0,ne.iH)(""),t=(0,ne.iH)("");const o=()=>{t.value="",e.dispatch("login",{username:s.value,password:a.value,success(){Ps.push({name:"userlist"})},error(){t.value="用户名或密码错误"}})};return{username:s,password:a,error_meassage:t,login:o}}};const as=(0,B.Z)(ss,[["render",es],["__scopeId","data-v-6d27a999"]]);var ts=as;const os=e=>((0,o.dD)("data-v-6ca25e3c"),e=e(),(0,o.Cn)(),e),ns={class:"row justify-content-md-center"},rs={class:"col-3"},ls={class:"mb-3"},cs=os((()=>(0,o._)("label",{for:"username",class:"form-label"},"用户名",-1))),us={class:"mb-3"},is=os((()=>(0,o._)("label",{for:"password",class:"form-label"},"密码",-1))),ps={class:"mb-3"},ds=os((()=>(0,o._)("label",{for:"password_confirm",class:"form-label"},"确认密码",-1))),ms={class:"error-message"},fs=os((()=>(0,o._)("button",{type:"submit",class:"btn btn-primary"},"登录",-1)));function _s(e,s,a,n,l,c){const u=(0,o.up)("ContentBase");return(0,o.wg)(),(0,o.j4)(u,null,{default:(0,o.w5)((()=>[(0,o._)("div",ns,[(0,o._)("div",rs,[(0,o._)("form",{onSubmit:s[3]||(s[3]=(0,t.iM)(((...e)=>n.register&&n.register(...e)),["prevent"]))},[(0,o._)("div",ls,[cs,(0,o.wy)((0,o._)("input",{"onUpdate:modelValue":s[0]||(s[0]=e=>n.username=e),type:"text",class:"form-control",id:"username"},null,512),[[t.nr,n.username]])]),(0,o._)("div",us,[is,(0,o.wy)((0,o._)("input",{"onUpdate:modelValue":s[1]||(s[1]=e=>n.password=e),type:"password",class:"form-control",id:"password"},null,512),[[t.nr,n.password]])]),(0,o._)("div",ps,[ds,(0,o.wy)((0,o._)("input",{"onUpdate:modelValue":s[2]||(s[2]=e=>n.password_confirm=e),type:"password",class:"form-control",id:"password_confirm"},null,512),[[t.nr,n.password_confirm]])]),(0,o._)("div",ms,(0,r.zw)(n.error_meassage),1),fs],32)])])])),_:1})}var vs={name:"RegisterView",components:{ContentBase:F},setup(){const e=(0,P.oR)();let s=(0,ne.iH)(""),a=(0,ne.iH)(""),t=(0,ne.iH)(""),o=(0,ne.iH)("");const n=()=>{o.value="",oe().ajax({url:"https://app165.acapp.acwing.com.cn/myspace/user/",type:"POST",data:{username:s.value,password:a.value,password_confirm:t.value},success(t){"success"===t.result?e.dispatch("login",{username:s.value,password:a.value,success(){Ps.push({name:"userlist"})},error(){o.value="用户名或密码错误"}}):o.value=t.result}})};return{username:s,password:a,password_confirm:t,error_meassage:o,register:n}}};const ws=(0,B.Z)(vs,[["render",_s],["__scopeId","data-v-6ca25e3c"]]);var gs=ws;const bs=(0,o.Uk)(" 404 ");function ys(e,s,a,t,n,r){const l=(0,o.up)("ContentBase");return(0,o.wg)(),(0,o.j4)(l,null,{default:(0,o.w5)((()=>[bs])),_:1})}var hs={name:"NotFound",components:{ContentBase:F}};const ks=(0,B.Z)(hs,[["render",ys]]);var Cs=ks;const js=[{path:"/myspace/",name:"home",component:G},{path:"/myspace/userlist/",name:"userlist",component:ce},{path:"/myspace/userprofile/:userId/",name:"userprofile",component:Fe},{path:"/myspace/login/",name:"login",component:ts},{path:"/myspace/register/",name:"register",component:gs},{path:"/myspace/404/",name:"404",component:Cs},{path:"/myspace/:catchAll(.*)",redirect:"/myspace/404/"}],Us=(0,S.p7)({history:(0,S.PO)(),routes:js});var Ps=Us,xs=a(1598);const Bs={state:{id:"",username:"",photo:"",followerCount:"",access:"",refresh:"",is_login:!1},getters:{},mutations:{updateUser(e,s){e.id=s.id,e.username=s.username,e.photo=s.photo,e.followerCount=s.followerCount,e.access=s.access,e.refresh=s.refresh,e.is_login=s.is_login},updataAccess(e,s){e.access=s},logout(e){e.id="",e.username="",e.photo="",e.followerCount=0,e.access="",e.refresh="",e.is_login=!1}},actions:{login(e,s){oe().ajax({url:"https://app165.acapp.acwing.com.cn/api/token/",type:"POST",data:{username:s.username,password:s.password},success(a){const{access:t,refresh:o}=a,n=(0,xs.Z)(t);setInterval((()=>{oe().ajax({url:"https://app165.acapp.acwing.com.cn/api/token/refresh/",type:"POST",data:{refresh:o},success(s){e.commit("updataAccess",s.access)}})}),27e4),oe().ajax({url:"https://app165.acapp.acwing.com.cn/myspace/getinfo/",type:"GET",data:{user_id:n.user_id},headers:{Authorization:"Bearer "+t},success(a){e.commit("updateUser",{...a,access:t,refresh:o,is_login:!0}),s.success()}})},error(){s.error()}})}},modules:{}};var Os=Bs,Ds=(0,P.MT)({state:{},getters:{},mutations:{},actions:{},modules:{user:Os}});(0,t.ri)(I).use(Ds).use(Ps).use(Ps).use(Ps).mount("#app")}},s={};function a(t){var o=s[t];if(void 0!==o)return o.exports;var n=s[t]={exports:{}};return e[t].call(n.exports,n,n.exports,a),n.exports}a.m=e,function(){var e=[];a.O=function(s,t,o,n){if(!t){var r=1/0;for(i=0;i<e.length;i++){t=e[i][0],o=e[i][1],n=e[i][2];for(var l=!0,c=0;c<t.length;c++)(!1&n||r>=n)&&Object.keys(a.O).every((function(e){return a.O[e](t[c])}))?t.splice(c--,1):(l=!1,n<r&&(r=n));if(l){e.splice(i--,1);var u=o();void 0!==u&&(s=u)}}return s}n=n||0;for(var i=e.length;i>0&&e[i-1][2]>n;i--)e[i]=e[i-1];e[i]=[t,o,n]}}(),function(){a.n=function(e){var s=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(s,{a:s}),s}}(),function(){a.d=function(e,s){for(var t in s)a.o(s,t)&&!a.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:s[t]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,s){return Object.prototype.hasOwnProperty.call(e,s)}}(),function(){a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={143:0};a.O.j=function(s){return 0===e[s]};var s=function(s,t){var o,n,r=t[0],l=t[1],c=t[2],u=0;if(r.some((function(s){return 0!==e[s]}))){for(o in l)a.o(l,o)&&(a.m[o]=l[o]);if(c)var i=c(a)}for(s&&s(t);u<r.length;u++)n=r[u],a.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return a.O(i)},t=self["webpackChunkmyspace"]=self["webpackChunkmyspace"]||[];t.forEach(s.bind(null,0)),t.push=s.bind(null,t.push.bind(t))}();var t=a.O(void 0,[998],(function(){return a(8873)}));t=a.O(t)})();
//# sourceMappingURL=app.ea3e3914.js.map